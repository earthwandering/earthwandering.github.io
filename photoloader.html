---
layout: basic
title:  Earth Wandering Photo Loader Tool
flickrkey: 2105c3f58a7d85488a10f2db6c151be1
flickrsecret: 49c062ce5df1d77f 
flickruserid: 100330886@N04
samplephotoset: 72157635232920260
---


<script type="text/javascript">
var flickrbase = 'http://api.flickr.com/services/rest/?jsoncallback=?';
var pagelog = null;
var output = null;

$(document).ready(function() {
	pagelog = $("#pagelog");
	output = $("#output");
		
	pagelog.append("Starting page load\n");
	loadPhotosets();
	pagelog.append("Done with page load\n");
});

function loadPhotosets() {
	var flickrargs = {format:'json', api_key: '{{page.flickrkey}}', user_id: '{{page.flickruserid}}', method: 'flickr.photosets.getList'};	

	$.getJSON(flickrbase, flickrargs, function(data) {		
		pagelog.append("photoset data:\n" + JSON.stringify(data) + "\n\n");
		
		$.each(data.photosets.photoset, function(index, itemdata) {
			var seturl = getSetUrl(itemdata.id);
			var settitle = itemdata.title._content;
			console.log("inputs: " + seturl + ", " + settitle);
			var setlink = getLinkHtml(seturl, settitle);

			pagelog.append("photoset: " + index + ":" + settitle + " " + setlink + " - " + itemdata.id + JSON.stringify(itemdata) + "\n");

			loadPhotosetPhotos(itemdata.id);
			
			output.append(setlink + '<pre id="set' + itemdata.id + '"></pre><br />');	
		});
		
		pagelog.append("Done iterating over data\n");
		
	});
}

function loadPhotosetPhotos(photosetid) {
	var flickrargs = {format:'json', api_key: '{{page.flickrkey}}', user_id: '{{page.flickruserid}}', photoset_id: photosetid, method: 'flickr.photosets.getPhotos'};	

	pagelog.append("photos (set:" + photosetid + ")");
	$.getJSON(flickrbase, flickrargs, function(data) {		
		pagelog.append("photos data:" + JSON.stringify(data) + "\n");
		
		$.each(data.photoset.photo, function(index, photodata) {
			pagelog.append("photo: " + JSON.stringify(photodata));
		
			var settarget = $('#set' + photosetid)
			
			settarget.append(getImageUrl(photodata.id, photodata.farm, photodata.server, photodata.secret, "") + "<br />");
		});
	});
}

function getImageUrl(imageId, farmId, serverId, secret, sizeCode) {
	//http://farm{farm-id}.staticflickr.com/{server-id}/{id}_{secret}_[mstzb].jpg
	//from http://www.flickr.com/services/api/misc.urls.html	

	var url = "http://farm" + farmId + ".staticflickr.com/" + serverId + "/" + imageId + "_" + secret
	if (sizeCode == "") {
		return url + ".jpg";
	} else {
		return url + "_" + sizeCode + ".jpg";
	}	
}

function getImageFlickrUrl(userId, imageId, setId) {
	//http://www.flickr.com/photos/100330886@N04/9594249168/in/set-72157635232920260
	var url = "http://www.flickr.com/photos/" + userId + "/" + imageId + "/in/set-" + setId;
	return url
}

function getSetUrl(setId) {
	console.log("getSetUrl(" + setId + ")");
	var out = "http://www.flickr.com/photos/{{page.flickruserid}}/sets/" + setId;
	console.log("set url: " + out);
	return out + ""
}

function getLinkHtml(urlstring, text) {
	console.log("getLinkHtml(" + urlstring + ", " + text + ")");
	var out = '<a href="' + urlstring + '">' + text + '</a>';
	console.log(out);
	return out;
}


</script>

<div id="output">

</div>


<pre id="pagelog">
{{page.title}}
Loading for flickrkey: {{page.flickrkey}}...
</pre>
